(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{2514:function(e,n,t){Promise.resolve().then(t.bind(t,1729))},1729:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return LoginPage}});var a=t(7437),o=t(9223),l=t(2265),u=t(4033),r=t(3198),s=t(5742),i=t(4829),d=t(2601);function LoginPage(){let[e,n]=(0,l.useState)(!1),[t,c]=(0,l.useState)(""),m=(0,u.useRouter)(),h=(0,r.I0)();async function handleLogin(e){let{email:t,password:a}=e;n(!0),c("");try{let e=await i.Z.post("".concat(d.env.NEXT_PUBLIC_API_URL,"/auth/login"),{email:t,password:a});h((0,s.QV)({user:e.data.user,token:e.data.token})),localStorage.setItem("ziya_lms_jwt",e.data.token),m.push("/courses")}catch(e){var o,l;c((null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(o=l.data)||void 0===o?void 0:o.message)||"Login failed")}finally{n(!1)}}return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Login"}),(0,a.jsx)(o.Z,{type:"login",onSubmit:handleLogin,loading:e,error:t})]})}},9223:function(e,n,t){"use strict";t.d(n,{Z:function(){return AuthForm}});var a=t(7437),o=t(2265);function AuthForm(e){let{type:n="login",onSubmit:t,loading:l,error:u}=e,[r,s]=(0,o.useState)({email:"",password:"",..."signup"===n?{name:""}:{}});function handleChange(e){s({...r,[e.target.name]:e.target.value})}function handleSubmit(e){e.preventDefault(),t(r)}return(0,a.jsxs)("form",{className:"space-y-4 max-w-md mx-auto",onSubmit:handleSubmit,children:["signup"===n&&(0,a.jsx)("input",{name:"name",type:"text",placeholder:"Name",className:"w-full border p-2 rounded",value:r.name,onChange:handleChange,required:!0}),(0,a.jsx)("input",{name:"email",type:"email",placeholder:"Email",className:"w-full border p-2 rounded",value:r.email,onChange:handleChange,required:!0}),(0,a.jsx)("input",{name:"password",type:"password",placeholder:"Password",className:"w-full border p-2 rounded",value:r.password,onChange:handleChange,required:!0}),(0,a.jsx)("button",{disabled:l,className:"w-full bg-blue-600 text-white rounded py-2 font-semibold",children:l?"Please wait...":"signup"===n?"Sign Up":"Login"}),u&&(0,a.jsx)("div",{className:"text-red-600",children:u})]})}},5742:function(e,n,t){"use strict";t.d(n,{QV:function(){return l},kS:function(){return u}});var a=t(64);let o=(0,a.oM)({name:"auth",initialState:{user:null,token:null},reducers:{setAuth:(e,n)=>{e.user=n.payload.user,e.token=n.payload.token},logout:e=>{e.user=null,e.token=null,localStorage.removeItem("ziya_lms_jwt")},restoreAuth:(e,n)=>{e.user=n.payload.user,e.token=n.payload.token}}}),{setAuth:l,logout:u,restoreAuth:r}=o.actions;n.ZP=o.reducer},4033:function(e,n,t){e.exports=t(94)}},function(e){e.O(0,[737,198,64,971,472,744],function(){return e(e.s=2514)}),_N_E=e.O()}]);